# 1
안녕하세요. 헬스 웨어러블을 이용한 올바른 운동자세 예측에 관하여 발표하겠습니다. 저는 센서 분석팀의 양진모입니다.
# 2
목차는 다음과 같습니다.
# 3
기존 운동에 대한 인식입니다.
# 4
다들 잘 알다시피 운동은 기본적으로 삶의 질 향상과 건강 유지를 위해 필수적입니다. 접근성이 용이하도록 스마트 폰이나 스마트 웨어러블로 사용자의 운동에 대해 분석하고 여러 수치들을 알려주는 사업이 활발합니다. 샤오미 미밴드를 보면 수면, 심박수, 칼로리 소모 등을 알려주고, 고중강도 운동을 하는지에 대한 여부를 알려줍니다.
# 5
스마트폰과 연동하여 더 자세한 수치를 알아볼 수도 있습니다.
# 6
애플워치는 운동 종목, 시간, 목표 설정이 가능하고, 운동량을 자세히 알려줍니다
# 7
하지만 이 두 웨어러블을 포함한 대부분은 운동의 수치를 알려주지, 자세에 대해서 알려주는 경우는 거의 없습니다. 운동 자세는 매우 중요합니다. 정자세로 운동을 해야 부상을 방지할 수 있고, 잘못된 자세로 인한 골격, 근육, 또는 신경이 상하는 것을 예방할 수 있습니다.
# 8
그래서 사람들은 영상이나 직접 체험함으로써 자세를 습득할 기대를 가지고 홈트레이닝이나 퍼스널 트레이닝을 알아보고는 합니다. 하지만 골격은 개개인마다 다를 수 있는데 홈트레이닝은 개인에 맞지 않는 자세일 수 있다는 점을 고려하지 않고 무조건 따라하면 된다는 식의 영상이 많습니다. 그리고 전문가의 피드백이 없어 동작을 취할 때 자세가 어떤지 알기 어렵습니다. 퍼스널 트레이닝은 이 부분을 해소해주지만 적지 않은 비용이 드는 것, 소비자가 트레이너를 불편해하거나 신체 접촉의 문제로 자세를 제대로 점검할 수 없다는 등의 단점이 있습니다.
# 9
종합적으로 살펴볼 때 스마트 웨어러블이 개인의 운동 자세에 대한 정보를 제공한다면 운동의 질이 향상될 것이고, 홈트레이닝과 퍼스널 트레이닝의 단점을 해결할 수 있어 경쟁력 있는 상품이 될 수 있을 것입니다.
# 10
사전준비입니다
# 11
데이터는 덤벨을 손에 쥐고 팔을 접어 올리고 내려 팔 근육을 강화시키는 덤벨 컬을 운동 종목으로 하고 있습니다. 5개의 자세를 구분하여 올바른 자세와 잘못된 자세를 나누고 있습니다.
# 12
A는 정자세이고, B는 팔꿈치를 내밀면서 드는 것, C와 D는 각각 절반만 들거나 내리는 것, 그리고 E는 골반을 앞으로 내밀면서 팔을 드는 것으로 구분되어 있습니다. 이 알파벳을 클래스라고 부르겠습니다. 이 클래스를 예측하기 위해 모델링에서 다중클래스 분류 모델을 사용하겠습니다.
# 13
그리고 6명의 피실험자를 대상으로 자료를 기록했고, 팔, 전완, 허리, 그리고 덤벨에 센서를 부착해 움직임을 포착했습니다. 센서들의 수치는 총 159개로 구분되어 있는데, 공통 기능을 보면 나침반 역할을 하는 자력계, 가속도 감지, 그리고 회전을 감지한 수치를 기록합니다. 이 159개를 특성이라고 부르겠습니다.
# 14
이러한 데이터를 가지고 무엇을 분석할 수 있는지 고려해 가설을 세웠습니다.
모델이 자세를 제대로 구분할 수 있는지에 대해 경우를 나누어 보았는데, 제일 쉬운 내용으로는 E에서 골반을 내밀면서 팔을 들기 때문에 허리 센서에서 A에서 D와는 다른 수치가 감지될 것입니다. C와 D는 운동반경이 각각 절반이므로 A, B, 그리고 E와 비교했을 때 일부 수치가 절반으로만 표기될 것으로 예상합니다. 그리고 모델은 조금이라도 잘못된 부분이 있으면 이를 교정해줄 수 있다면 좋을 것인데, A와 B는 팔과 전완의 움직임이 서로 크게 다르지 않아서 다른 클래스에 비해 모델의 분류가 정확하지 않을 수 있을 것으로 예상합니다. 이렇게 되면 센서를 더욱 연구하고 보완해야 합니다.
또한 센서는 3차원으로 수치들을 표기하기 때문에 하나의 세부 센서의 수치들이 비슷한 양상을 보일 수 있고, 몸은 연결되어 있어서 팔을 움직일 때 전완이 같이 움직이는 등을 생각해볼 수 있습니다. 이를 상관관계가 크다고 말합니다. 따라서 몇몇의 수치가 비정상적일지라도 다른 수치로부터 상황을 파악할 수 있기 때문에 모델 학습에 큰 문제는 없을 것으로 예상합니다.
# 15
데이터를 모델링에 사용할 수 있는 형태로 만들기 위해 살펴본 내용을 말씀드리겠습니다.
개별 특성들을 확인해보면 대략 10 번의 움직임을 확인할 수 있습니다.
# 16
데이터셋 내에 동작과 상관 없이 2.5초 단위로 평균값이나 변화량을 나타내는 특성 삭제했습니다.

비정상적 수치가 나타나는 인원이 아닌 다른 인원으로 모델링을 진행할 것입니다.
# 18
가설 확인을 위해 추가 그래프를 그려보았습니다. E 클래스는 허리 움직임으로 인해 다른 클래스와는 구분되는 것을 확인할 수 있습니다. C와 D는 절반만 움직이기 때문에 일부 수치가 다른 클래스에 비해 절반만 나타나는 것을 확인할 수 있습니다.
# 19
A와 B의 구분이 어려울 것이라는 예상으로 전완에 대한 그래프를 보면 운동 시작 후부터 끝날 때까지 수치에 변화는 있지만 A와 B는 큰 차이는 없어 보입니다.
# 20
팔도 마찬가지입니다.
# 21
시각적으로 확인한 부분을 머신러닝으로 확인해보겠습니다.
# 22
머신러닝의 구축은 모델을 학습하는 훈련, 잘 학습했는지 검증, 그리고 미래에 수집한 것으로 간주한 데이터로 평가를 진행합니다. 이 순서로 진행하기 위해 데이터를 훈련용, 검증용, 그리고 평가용 데이터셋으로 구분할 필요가 있습니다.
# 23
데이터셋을 구분하기 위해 각 클래스별로 10개의 움직임으로 구분하고, 일부를 검증, 그리고 다른 일부를 평가로 하고 나머지는 훈련으로 사용했습니다.
# 24
기준모델과 평가지표를 말씀드리겠습니다. 기준모델은 모델의 성능이 최소한 이 모델보다 높을 것을 기준으로 삼는 모델입니다. Decision Tree Classifier는 분류 모델에서 가장 단순한 모델링 알고리즘입니다. 모델의 성능을 평가하는 평가지표는 micro F1점수와 micro AP 점수를 사용할 것인데, 이것이 무엇인지와 선정 이유를 말씀드리겠습니다.
# 25
클래스의 분포를 보면 다음과 같습니다. 약간의 불균형이 있는 것을 확인하실 수 있습니다. 균형이 있을 때와 불균형이 있을 때 모델의 성능을 평가하는 지표는 다릅니다. 불균형의 상황에서 주로 사용하는 지표는 F1과 AP입니다.
# 26
F1 점수는 다음으로 확인하실 수 있습니다. 모델이 분류한 결과에서 실제 클래스에 해당하는 비율이 정밀도, 실제 클래스에 해당하는 부분에서 모델이 제대로 분류한 비율을 재현율이라고 합니다. F1은 일종의 평균 기법을 사용하여 정밀도와 재현율로 나타낸 평가 지표입니다.
micro는 다중클래스에서 각 클래스별로 맞춘 개수와 그렇지 않은 개수들을 각각 더해 정밀도과 재현율을 계산한 후 F1을 계산한 것을 의미합니다.
# 30
AP, 또는 Average Precision 점수를 말씀드리자면, 재현율과 정밀도가 동시에 높은지에 대한 것을 수치화한 점수입니다. 보시는 그래프는 재현율과 정밀도를 표현한 그래프인데, 이 그래프 아래 면적이 클수록 재현율과 정밀도가 동시에 높고, 이 수치를 AP라고 합니다.
# 31
이제 기준모델을 확인해보겠습니다. micro F1은 0.893, AP는 0.919로 적당히 높은 수치를 보여줍니다.
# 32
이 기준모델보다 성능이 좋은 다른 알고리즘이 있는지 확인해보겠습니다.
Random Forest classifier라는 알고리즘을 사용해보고, Light GBM Classifier이라는 알고리즘을 사용해보았습니다.
# 33
약간의 학습방향 조정으로 Light GBM Classifier이 더 좋을 것으로 예상해 이를 선택했습니다.
# 34
Light GBM Classifier는 일종의 Gradient Boosting 알고리즘으로 여러 번 모델을 만들어 학습하는 알고리즘인데, 처음에는 성능이 낮은 모델로 시작해 실제값과의 차이 즉 잔차를 학습해 이 잔차를 줄여나가는 방향으로 다음 모델을 구성하는 알고리즘입니다.
# 35
모델의 성능을 높이기 위해 방향성을 지정해줄 수 있습니다. 이를 하이퍼파라미터 튜닝이라 부릅니다. Gradient Boosting에 튜닝하는 대표적인 하이퍼파라미터로는 learning rate, max_depth입니다. Learning Rate는 학습률로, 모델을 반복해서 만들 때 100퍼센트까지 얼마 만큼 진행도로 다음 모델을 만들지에 대한 수치로 이해하시면 됩니다. max_depth는 어느 정도 깊이까지 클래스를 구분하고 멈출지에 대한 것입니다. 이를 조절함으로 모델이 훈련 데이터에 너무 적합하게 되는 것을 방지할 수 있습니다.
# 36
순서대로 약간씩 평가 지표의 숫자가 올라가며 성능이 약간씩 좋아지는 것을 확인할 수 있습니다.
# 40
하이퍼파라미터 튜닝을 마친 후 평가 데이터셋으로 평가해보았습니다. 하나도 틀림 없이 모두 정확히 예측했음을 알 수 있습니다.
# 41
모델링 결과 분석입니다.
# 42
왜 모델이 이런 결과를 냈는지 확인해보고자 했습니다. 특성 중요도는 어떤 특성을 중요하게 판단하여 분류했는지를 알려주는 지표입니다. 각각의 클래스에 대한 특성 중요도를 보고자 했습니다만, 간략하게 결론을 드리면 판단하기 어렵습니다. 부정확하거나 노이즈가 많은 특성의 잔차를 줄이기 위해 이 특성들이 더 많이 학습했기 때문에 중요도가 높다고 판단하는 오류가 있었습니다.

다음을 보시면 D의 구분에서 중요한 특성 탑 쓰리인데, 두 번째는 달라 보여도 첫 번째와 세 번재가 왜 다른지는 알기 어렵습니다.

하지만 그럼에도 불구하고 제일 구분하기 어렵다고 예상했던 A와 B를 모델은 정확하게 구분했습니다. 사람의 눈이 잡아내지 못한 특성을 모델이 잘 학습했으므로, 덤벨 컬에 대해서는 데이터를 기록한 센서의 수준이 적당했다는 것을 알 수 있습니다.
# 57
특성들 간 상관관계가 크기 때문에 부정확한 수치가 있어도 학습에 문제가 없을 것이라고 또한 예상했었는데, 보시는 바와 같이 센서에 문제가 있었던 피실험자의 데이터로 별도 학습한 모델은 좋은 결과를 주고 있습니다.
# 58
고찰 및 향후 목표입니다.
# 59
기존 웨어러블에 추가 기능을 더하고, 사용자가 홈트레이닝이나 퍼스널 트레이닝 없이 올바른 자세의 운동을 할 수 있는 모델을 만들고자 했습니다. 하지만 모델은 자세를 학습할 뿐이지, 이 자세가 좋은 자세인지 그렇지 않은지는 판단할 수 없습니다. 예를 들어 각각의 클래스와 실제 자세가 일치하지 않은 Eurico의 경우 모델을 별도로 학습시켜보면 클래스를 잘 분류합니다.
# 60
따라서 다음과 같이 생각해볼 수 있습니다. 이 센서 및 모델을 사용하기 위해 사용자는 운동 전문가, 즉 트레이너를 만나 여러 자세로 모델을 학습시킵니다. 이후 특정 기간동안은 혼자 운동할 수 있겠습니다. 그러다 근육 발달, 체형 변화, 또는 나쁜 습관으로 인해 사용자는 제대로 운동하는 것 같지만 웨어러블이 잘못된 자세라 알려주는 빈도가 커질 수 있기 때문에 특정 기간 이후 다시 전문가를 만나 다시 모델을 학습해주는 것이 좋아 보입니다.
# 61
그리고 센서에 문제점이 있습니다.
노이즈가 끼거나 비정상적인 수치가 있었습니다만, 모델의 결과는 좋았습니다. 따라서 센서의 민감도와 센서 개발 비용을 따져보아 적당한 수준에서 자세를 잘 구분하는 지점을 찾는 것이 좋아 보입니다.
또한 모델은 덤벨 컬에 대해 팔, 전완, 허리, 그리고 덤벨에 센서를 부착했는데, 다른 종목의 운동이라면 센서의 위치가 달라질 것입니다. 이 부분을 고려하여 센서의 종류나 개수 선정이 바뀌게 될텐데, 최대한 다양한 종목의 운동을 커버할 수 있는 개수를 찾는 추가 연구가 필요합니다.
# 62
또한 측정 단위의 조정이 필요합니다. 기록한 데이터는 한 번 동작에 대한 구분이 자체적으로 표기되지 않습니다. 반복적인 특징을 학습하는 모델 또한 개발하여 개별 움직임 단위 자체를 구분할 수도 있겠습니다. 이러한 것에 추가로 한 번 움직인 것이나, 한 세트 운동한 것에 대해 자세를 얼마나 잘 유지했는지 이탈했는지, 그리고 기존 웨어러블의 수치들을 함께 제공한다면 사용자에게 보다 나은 서비스를 제공하고 이목을 끌 수 있을 것입니다.
# 63
감사합니다.